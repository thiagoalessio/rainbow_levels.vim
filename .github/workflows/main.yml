name: CI

on: [push, pull_request]

jobs:
  test:
    name: Test
    runs-on: ubuntu-latest
    container: thiagoalessio/vader-vim
    steps:
    - name: Running tests with code coverage
      run: |
        covimerage run vim -Nu <(cat << VIMRC
        filetype off
        set rtp+=/vader.vim
        set rtp+=.
        set rtp+=after
        filetype plugin indent on
        VIMRC
        ) -c 'Vader! test/*' >/dev/null
    - name: Submitting code coverage report
      run: covimerage xml --omit */default_colors/* && codecov
